;;ALP EMIR BILEK
;;161044049
(setf *outputList* nil)
(setf operatorList '("+" "-" "/" "*" "(" ")" "**" "," "'"))
(setf keywordList '("and" "or" "not" "equal" "less" "nil" "list" "append" "concat" "set" "deffun" "for" "if" "exit" "load" "disp" "true" "false" "defvar" "while" "for"));;Defines keywords
(setf keywordListstr '("KW_AND" "KW_OR" "KW_NOT" "KW_EQUAL" "KW_LESS" "KW_NIL" "keywordList" "KW_APPEND" "KW_CONCAT" "KW_SET" "KW_DEFFUN" "KW_FOR" "KW_IF" "KW_EXIT" "KW_LOAD" "KW_DISP" "KW_TRUE" "KW_FALSE" "KW_DEFVAR" "KW_WHILE" "KW_FOR"));;These are for printing correspondance keywords
(defun addPUSH(str)
  (push (list str) *outputlist*)

)
(defun IDcheck (line)
    (cond ((digit-char-p (car line)) (progn (add "Error") -1))
          (t (if (not (eq (position (coerce line 'string) keywordList :test #'string=) nil)) (addPUSH (nth (position (coerce line 'string) keywordList :test #'string=) keywordListstr)) (addPUSH "IDENTIFIER")))
    )
)
;;This function is general line check.It means is it 
(defun Lexcheck (line)
    (cond ((and (not (eq (list-length line) 1)) (char= #\0 (car line))) (progn (addPUSH "Error") -1))
          ((not (Alphacheck line)) (progn (addPUSH "Error") -1))
          ((and (eq (list-length line) 1) (char= #\0 (car line))) (push (list "VALUE" (format nil "狺扉铄┅秕麴豸扉篝┅ㄩ铒ㄖ犰蹂汨邈扉铄┅ㄉ你桢汶扉铄瘐箬扉篝⒅撂张ㄦ矧磲铋狺扉铄┅秕麴豸扉篝┅换澡轶骢钽糸镱溴汩溴轶轸鲠祯矧铒舢ㄤ彐躅轴祯邈桢汶扉铄ㄣ镱铛祆扉铄舂换涉轸轶铛祆蝈趱蝾è铒ㄤ殓轸汨狎ㄣ狎扉铄┅铋飑换描邈脲骘溟玳矧铒ㄖ犰蹂汨邈毹沅扉铄┅换轸弪狒翳玳鲥扉铄换澡轶骢钽糸镱汨邈翳扉铄轶犰痂犷蹴弪殂矧铒舢婶礤犷蟋轸溴汩溴轶轸镳弪狒矧矧铒舁脲黠蜾犷殇孱糸骈弪┊ㄤ彐躅领痂徙桢汶扉铄ㄣ镱铛祆扉铄舂换涉轸轶铛祆蝈趱蝾è铒ㄡ祓栳铛礤蜷沭ㄣ狎扉铄┅铋飑换汨邈脲骘犰痂犷蹴弪殂矧铒领痂徙桢汶ㄣ潋扉铄┅换轸弪狒翳玳鲥扉铄换澡轶骢钽糸镱轶躞邃骘玳鲥汨狎徙翦轶汨狎徙翦矧镳弪狒轱町换义趱蝾骘汨狎徙弪灰弭躜铙骘镳弪狒轱铙ㄤ彐躅汨狎渺狍ㄣ栳颟ㄣ镱换腻翦蝽轭翳汨狎徙翦沆狍ㄡ祓栳铛礤蜷沭汨狎暴换骑汨狎犷铛礅弪癌换骑镳弪狒轱铙ㄤ彐躅珏袅祓栳ㄓ粢扉铄戾è疱咫汨狎铋郁铋飑┅换婶弪狒翳玳鲥篝蜷铉镱怡镱蝈沲蝮轹屐ㄣ镱è铒ㄥ铋礤礅弪篝蜷铉悌镳弪狒矧涕篝呼弩＇篝蜷铉僵┅蝈鲥蝮扉铄┅换描邈脲骘镳弪狒矧扉篝殒轸泔铘衢铋铉轭瘐箬轸è矧ㄥ＼羽徙濠ㄥ铋飑蝈鲥蝮扉铄┅换涉轸轶麒轸弩疳沐痱镧瘐箬蝈徜汨狎郁药扉铄ㄧ弭领痂郁扉铄┅换蝈沲蝮轹汜祆换澡轶骢钽糸镱躞邃骘镡翎轭轭翳镳弪狒轱铙豉疱犷瘐箬弩轸麸秕麴豸扉篝ㄤ彐躅闲瘐箬镳ㄩ篝蜷铉镳④ㄡ滗姓尤⑾羞厦┗簧轸轶瘐箬轸麸翳秕麴豸扉篝ㄩ篝蜷铉镳ㄡ滗姓尤⑾羞孟屯立┗簧轸轶瘐箬轸麸翳秕麴豸扉篝ㄩ篝蜷铉镳Бㄡ滗姓尤⑾羞颜息┗簧轸轶瘐箬轸麸翳秕麴豸扉篝ㄩ篝蜷铉镳ㄡ滗姓尤⑾羞驼淘┗簧轸轶瘐箬轸麸翳秕麴豸扉篝ㄩ篝蜷铉镳ㄡ滗姓尤⑾羞眯┗簧轸轶瘐箬轸麸翳秕麴豸扉篝ㄩ篝蜷铉镳áㄡ滗姓尤⑾羞闲┗簧轸轶堠瘐箬轸麸翳秕麴豸扉篝ㄩ篝蜷铉镳ㄡ滗姓尤⑾羞厦┗簧轸轶瘐箬轸麸翳秕麴豸扉篝ㄩ篝蜷铉镳ㄡ滗姓尤⑾羞纳症┗簧轸轶瘐箬轸麸翳秕麴豸扉篝ㄩ篝蜷铉镳ㄡ滗姓尤⑾羞刑沼┗簧轸轶瘐箬轸麸翳秕麴豸扉篝ㄩ篝蜷铉镳ㄡ滗姓尤⑾羞蜕握英┗簧轸轶瘐箬轸麸翳秕麴豸扉篝换歪轭骢钽糸镱换澡轶磲骢钽糸镱溴汩溴轶轭瘐骈戾玳鲥怡狎珲屙孱矧铒舢换零惝麸翳轶轭骘痱镧蜥鏖祆忮屮邈豸邃ㄤ彐躅磲轭疳蜥愆箦赳轭瘐舸ㄣ狎狎珞┅换翎脲狎珲礤铘骝镯脲怙狎ㄣ镱è羼狎珞铋飑换汨邈翳铛祆矧铒翦蝽轭犰暴换殒轸轶铛祆汜祆翳翦蝽轭犰骢钽蝈徜骈戾轭瘐舸换殒轸轶铒汜祆翳骈戾骢钽疳蝮弪疳蜥愆换义徜弪骝镯脲怙狎换澡狒泔钿轶黩轸翦骘屙痿篝蜷铉换涉屙痿篝蜷铉翎脲骝镯脲怙狎痱镧蜥鏖祆翦蝽轭狒邃犷秕麴豸镦翳玳鲥轭瘐趔鏖祆忮黩雉麸秕麴豸骈戾萧桢蝼轶痱镧蜥脲屦狍腴铉骘铄扉铄ㄤ彐躅翦蝽轭犰疳颟箦赳轭瘐蝈徜扉铄┅ㄣ镱è戾铉翳ㄣ镱汜翦钺翦篝蜷铉轭瘐⑨祓┅┗昏徜箫礤轶篚徕秕汨邈腴铉翳屙痿篝蜷铉箫泔钽狒孱狒轸鏖翳⑨祓犷汨邈翳蝈篚祠戾铉翳换殒轸轶箫蝈趱蝾犷翦蝽轭狒箦赳秕麴豸涕篝躅轱秕麴豸涕篝戾弪轭瘐舂┅换屐箦汜祆翳戾弪礤翳镤翦蝽轭犰疳颟换脲屦滹轭绋蝈沲蝮轹濠换义徜骝镯轭瘐骈戾扉铄怡扉铄换澡孱箦钿翳屙麸戾弪骢钽糸镱犷躅轸翳犰扉铄秕麴豸扉篝ㄤ彐躅蝈徜骈戾ㄦ殪孱犴濠戾è轭镳孱骈戾钺礤洪姝滹弩铒舡屮轶铋飑┅换镳孱骈戾麒孱轭祜镳骘扉铄蝈徜扉铄轭铋飑换蝈徜骈戾扉铄怡扉铄麒殪扉铄滹箦赳秕麴豸涕篝躅轱秕麴豸涕篝戾弪扉铄┅换汜祆翳戾弪鏖翳扉铄ㄣ祜箦轭换沆矬骈戾换歪轭体弪骢钽糸镱换澡轶骢钽糸镱汜祆翳蝈聃轵邃桢祓弪骢钽糸镱犷轸珏铄蜥翦犷秕麴豸徙惝麸泔钿犷瘐箬弩麸秕麴豸扉篝换留翳孱蝈鲥蝮弩翳秕麴豸扉篝忮汜躞蔑眄镱涕箴瘐箬礤翳镤黠螂扉脲郁徙篝蝓泗躜瀹ㄤ彐躅戾弪篝蜷瞟箦赳秕麴豸涕篝铋飑换蝈骝弩翳珈镡犰扉篝戾è篝磲脲篝蜷铉轭瘐舡篝蝈犴篝蜷瞟┅换泔铞弪轸麸篝蜷铉祜镳麒殪铒ㄥ疱咫汨狎铋篝铋飑铋飑滹换泔铘蝻轸汨狎怡汨狎戾è蝈徜汨狎篝颟扉铄┅换蝈徜骝镯玳鲥篝蜷铉ㄣ镱è犷ㄣ栳蚪＼悌ㄣ栳蚪疱咫汨狎铋篝铋飑＼哗痱镧ㄡ滗姓尤⒚贤团卧孟屯盼寓蝈趱蝾┅换殒轸轶羼踽麸⒒瘐箬轸狍孟屯盼è羼ㄣ栳蛎灬篌悌癌换殒轸轶镳弪狒矧ㄩㄡ钿篝蜷铉疱咫汨狎铋篝铋飑篝蜷铉┅ㄏ叙躞ㄣ镱汜翦钺翦篝蜷铉篝蜷铉悌篝蜷铉蝈徜汨狎篝颟┅ㄏ叙躞悌┅换殒轸轶镳弪狒矧镡翎轭翳麒殂镱轶犷箦钿轸麸镳絮箬礤翳镤è羼ㄣ栳蛎灬篌悌暴换涉轸轶汨狎汜祆翳戾弪汨邈脲犷箦钿轸麸栝痱镧瘐箬扉铄ㄩㄥㄌ屮汨邈ㄧ弭领痂篝扉铄┅ī┅┗簧骘弪蝻汨邈蝈鲥蝮秕麴豸涕篝换汜躞镦扉箴瘐箬骢钽糸镱栳鲥麸蝈鲥蝈ㄤ彐躅疳蝮弪疳蜥愆箦赳眯咩秕铘弪癌箦赳闲咩秕铘弪癌箦赳御铘狲咩秕铘弪癌祜镳骘轭秕麴豸扉篝滹ㄣ镱è羼踽ㄣ狎椹⑾羞闲ㄩ钽闲咩秕铘弪ㄩㄥ聃犰ㄣ狎椹⑾羞眯ㄩ钽眯咩秕铘弪┅ㄩ篝蜷铉羼踽ㄣ狎椹⑴蝌矧ㄩ钽御铘狲咩秕铘弪ㄩ矧ǒ眯咩秕铘弪闲咩秕铘弪御铘狲咩秕铘弪癌痱轭⒂铘狲膨蝻颌ㄧ痧嗅蝮弪疳蜥ㄣ潋秕麴豸扉篝┅ㄤ彐躅琊鹦狎箦ㄦ殪孱犴戾屙濠箦赳赭锾弭翦篚怏羼ㄣ狎ㄣ狎戾屙濠博箦赳义癌ㄩ篝蜷铉羼踽赭锾弭翦⑾孝箦赳义ㄏ戾屙濠ㄩ篝蜷铉羼踽赭锾弭翦⑺注痱轭⑺疳螋鏖祆忮轫痨屙孱翦洧ㄩ篝蜷铉羼踽赭锾弭翦⑸蘑痱轭⑸疳螋鏖祆忮轫痨屙孱翦洧黩轸弪骈戾钺礤义螬ㄤ彐躅黩轸弪ㄦ殪孱犴耨鏖翳镳孱骈戾秕骈戾钺礤轰轵邈糸镱猴豸瘐洪姝屮轶趔横痧孱洪姝滹弩铒舡屮轶恒蝈狒濠ㄦ矧磲秕⒁弩蹯轶湖ア耨┅ㄤ彐躅闲戾屙濠箦赳蝈篚铋飑ㄣ镱è羼踽ㄣ狎戾屙濠Ж⑾羞蜕握英┅箦赳蝈篚祠ō疳蝮瀛轭翦珏颞汜颞沅颞汜颞沅戾屙濠┅┅疳蝮瀛轭翦珏颞汜颞沅颞汜颞沅ㄣ潋戾屙濠┅┅┅ㄣ镱è羼踽ㄣ狎戾屙濠Ж⑾羞刑沼┅箦赳蝈篚祠ǐ疳蝮瀛轭翦珏颞汜颞沅颞汜颞沅戾屙濠┅┅疳蝮瀛轭翦珏颞汜颞沅颞汜颞沅ㄣ潋戾屙濠┅┅┅ㄩㄥ聃犰ㄣ狎戾屙濠Ж⑾羞纳症┅箦赳蝈篚祠ǒ疳蝮瀛轭翦珏颞汜颞沅颞汜颞沅戾屙濠┅┅疳蝮瀛轭翦珏颞汜颞沅颞汜颞沅ㄣ潋戾屙濠┅┅┅ㄩㄥ聃犰ㄣ狎戾屙濠Ж⑾羞驼淘┅箦赳蝈篚祠í疳蝮瀛轭翦珏颞汜颞沅颞汜颞沅戾屙濠┅┅疳蝮瀛轭翦珏颞汜颞沅颞汜颞沅ㄣ潋戾屙濠┅┅┅蝈篚祠磲轭疳蝮邃哽轶甬豇簪